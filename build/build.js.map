{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/main.js","src/synth.js","src/synth_components/oscillator.js"],"names":[],"mappings":"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","file":"build.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\r\n\r\nimport Synth from './synth.js';\r\n\r\n// Instantiate the Synth\r\n// And link the audio context container\r\nconst synth = new Synth(new ( window.AudioContext || window.webkitAudioContext )());\r\n\r\n/*\r\n    Getting the note frequencies:\r\n\r\n    The base for calculating the frequencies is 440 Hz, this is a A4- the first\r\n    A note above middle C (C4).\r\n\r\n    All note frequencies are calculated from this point on with the following calculation:\r\n    The base frequency TIMES the twelfth root of two TO THE POWER OF the amount of half steps from A4.\r\n    In short: 440 * (2^(1/12))^h. Where h is the half steps away from A4 (which will be negative if \r\n    we travel to the left on the keyboard).\r\n */\r\nconst ul = document.getElementById(\"keyboard\");\r\nconst items = ul.getElementsByTagName(\"li\");\r\n\r\n// When the user presses down on a keyboard list element\r\n// we will calculate the frequency of the note and play it\r\nfor (let i = 0; i < items.length; ++i) {\r\n    items[i].onmousedown = function(){\r\n        synth.setFrequency(parseInt(this.dataset.half));\r\n        synth.start();\r\n    }\r\n\r\n}\r\n\r\n// On Mouseup we will stop all oscillators, I'm putting this on document.body\r\n// instead of on the list elements because the user can hold down the key while\r\n// still moving the mouse, which messes it all up\r\ndocument.body.onmouseup = function(){\r\n   synth.stop();\r\n};\r\n\r\n/*\r\n Shifting the keyboard to the left or right using the octave controls\r\n */\r\nlet octaveRange = 1; // The default state\r\ndocument.querySelector('[data-ctrl=\"octave-left\"]').addEventListener('click', function(){\r\n    if( !this.classList.contains('active')) {\r\n        document.querySelector('[data-ctrl=\"octave-right\"]').classList.remove('active');\r\n        octaveRange++;\r\n        if( octaveRange > 1 ) this.classList.add('active');\r\n        moveKeyboardOctave('down');\r\n    }\r\n});\r\ndocument.querySelector('[data-ctrl=\"octave-right\"]').addEventListener('click', function(){\r\n    if( !this.classList.contains('active')) {\r\n        document.querySelector('[data-ctrl=\"octave-left\"]').classList.remove('active');\r\n        octaveRange--;\r\n        if( octaveRange < 1 ) this.classList.add('active');\r\n        moveKeyboardOctave('up');\r\n    }\r\n});\r\nfunction moveKeyboardOctave( direction ){\r\n    let halfStep;\r\n    if( direction === 'up' ){\r\n        for (let i = 0; i < items.length; ++i) {\r\n            halfStep = parseInt(items[i].dataset.half) + 12;\r\n            items[i].dataset.half = half;\r\n        }\r\n    } else {\r\n        for (let i = 0; i < items.length; ++i) {\r\n            halfStep = parseInt(items[i].dataset.half) - 12;\r\n            items[i].dataset.half = half;\r\n        }\r\n    }\r\n}","import Oscillator from \"./synth_components/oscillator\";\r\n\r\nclass Synth{\r\n    constructor(context){\r\n        this.context = context;\r\n        this.oscillators = [\r\n            new Oscillator(context),\r\n            new Oscillator(context)\r\n        ];\r\n    }\r\n\r\n    get Oscillators(){\r\n        return this.oscillators;\r\n    }\r\n\r\n    setFrequency(halfStep){\r\n        this.oscillators.forEach(function(osc){\r\n            osc.setFrequency(halfStep);\r\n        });\r\n    }\r\n\r\n    start(){\r\n        this.oscillators.forEach(function(osc){\r\n            osc.start();\r\n        });\r\n    }\r\n\r\n    stop(){\r\n        this.oscillators.forEach(function(osc){\r\n           osc.stop();\r\n        });\r\n    }\r\n}\r\n\r\nexport default Synth;","class Oscillator{\r\n    constructor(context){\r\n        this.context = context;\r\n    }\r\n    setFrequency(halfStep){\r\n        this.frequency = 440 * ( Math.pow( Math.pow(2, 1/12), halfStep) );\r\n    }\r\n    start(){\r\n        this.oscillator = this.context.createOscillator();\r\n        this.oscillator.connect(this.context.destination);\r\n        this.oscillator.frequency.value = this.frequency;\r\n        this.oscillator.start();\r\n    }\r\n    stop(){\r\n        this.oscillator.stop();\r\n    }\r\n}\r\n\r\nexport default Oscillator;"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvbWFpbi5qcyIsInNyYy9zeW50aC5qcyIsInNyYy9zeW50aF9jb21wb25lbnRzL29zY2lsbGF0b3IuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTs7QUFFQTs7Ozs7O0FBRUE7QUFDQTtBQUNBLElBQU0sUUFBUSxvQkFBVSxLQUFNLE9BQU8sWUFBUCxJQUF1QixPQUFPLGtCQUFwQyxHQUFWLENBQWQ7O0FBRUE7Ozs7Ozs7Ozs7O0FBV0EsSUFBTSxLQUFLLFNBQVMsY0FBVCxDQUF3QixVQUF4QixDQUFYO0FBQ0EsSUFBTSxRQUFRLEdBQUcsb0JBQUgsQ0FBd0IsSUFBeEIsQ0FBZDs7QUFFQTtBQUNBO0FBQ0EsS0FBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLE1BQU0sTUFBMUIsRUFBa0MsRUFBRSxDQUFwQyxFQUF1QztBQUNuQyxVQUFNLENBQU4sRUFBUyxXQUFULEdBQXVCLFlBQVU7QUFDN0IsY0FBTSxZQUFOLENBQW1CLFNBQVMsS0FBSyxPQUFMLENBQWEsSUFBdEIsQ0FBbkI7QUFDQSxjQUFNLEtBQU47QUFDSCxLQUhEO0FBS0g7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsU0FBUyxJQUFULENBQWMsU0FBZCxHQUEwQixZQUFVO0FBQ2pDLFVBQU0sSUFBTjtBQUNGLENBRkQ7O0FBSUE7OztBQUdBLElBQUksY0FBYyxDQUFsQixDLENBQXFCO0FBQ3JCLFNBQVMsYUFBVCxDQUF1QiwyQkFBdkIsRUFBb0QsZ0JBQXBELENBQXFFLE9BQXJFLEVBQThFLFlBQVU7QUFDcEYsUUFBSSxDQUFDLEtBQUssU0FBTCxDQUFlLFFBQWYsQ0FBd0IsUUFBeEIsQ0FBTCxFQUF3QztBQUNwQyxpQkFBUyxhQUFULENBQXVCLDRCQUF2QixFQUFxRCxTQUFyRCxDQUErRCxNQUEvRCxDQUFzRSxRQUF0RTtBQUNBO0FBQ0EsWUFBSSxjQUFjLENBQWxCLEVBQXNCLEtBQUssU0FBTCxD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ZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIlwidXNlIHN0cmljdFwiO1xyXG5cclxuaW1wb3J0IFN5bnRoIGZyb20gJy4vc3ludGguanMnO1xyXG5cclxuLy8gSW5zdGFudGlhdGUgdGhlIFN5bnRoXHJcbi8vIEFuZCBsaW5rIHRoZSBhdWRpbyBjb250ZXh0IGNvbnRhaW5lclxyXG5jb25zdCBzeW50aCA9IG5ldyBTeW50aChuZXcgKCB3aW5kb3cuQXVkaW9Db250ZXh0IHx8IHdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQgKSgpKTtcclxuXHJcbi8qXHJcbiAgICBHZXR0aW5nIHRoZSBub3RlIGZyZXF1ZW5jaWVzOlxyXG5cclxuICAgIFRoZSBiYXNlIGZvciBjYWxjdWxhdGluZyB0aGUgZnJlcXVlbmNpZXMgaXMgNDQwIEh6LCB0aGlzIGlzIGEgQTQtIHRoZSBmaXJzdFxyXG4gICAgQSBub3RlIGFib3ZlIG1pZGRsZSBDIChDNCkuXHJcblxyXG4gICAgQWxsIG5vdGUgZnJlcXVlbmNpZXMgYXJlIGNhbGN1bGF0ZWQgZnJvbSB0aGlzIHBvaW50IG9uIHdpdGggdGhlIGZvbGxvd2luZyBjYWxjdWxhdGlvbjpcclxuICAgIFRoZSBiYXNlIGZyZXF1ZW5jeSBUSU1FUyB0aGUgdHdlbGZ0aCByb290IG9mIHR3byBUTyBUSEUgUE9XRVIgT0YgdGhlIGFtb3VudCBvZiBoYWxmIHN0ZXBzIGZyb20gQTQuXHJcbiAgICBJbiBzaG9ydDogNDQwICogKDJeKDEvMTIpKV5oLiBXaGVyZSBoIGlzIHRoZSBoYWxmIHN0ZXBzIGF3YXkgZnJvbSBBNCAod2hpY2ggd2lsbCBiZSBuZWdhdGl2ZSBpZiBcclxuICAgIHdlIHRyYXZlbCB0byB0aGUgbGVmdCBvbiB0aGUga2V5Ym9hcmQpLlxyXG4gKi9cclxuY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImtleWJvYXJkXCIpO1xyXG5jb25zdCBpdGVtcyA9IHVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwibGlcIik7XHJcblxyXG4vLyBXaGVuIHRoZSB1c2VyIHByZXNzZXMgZG93biBvbiBhIGtleWJvYXJkIGxpc3QgZWxlbWVudFxyXG4vLyB3ZSB3aWxsIGNhbGN1bGF0ZSB0aGUgZnJlcXVlbmN5IG9mIHRoZSBub3RlIGFuZCBwbGF5IGl0XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcclxuICAgIGl0ZW1zW2ldLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBzeW50aC5zZXRGcmVxdWVuY3kocGFyc2VJbnQodGhpcy5kYXRhc2V0LmhhbGYpKTtcclxuICAgICAgICBzeW50aC5zdGFydCgpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuLy8gT24gTW91c2V1cCB3ZSB3aWxsIHN0b3AgYWxsIG9zY2lsbGF0b3JzLCBJJ20gcHV0dGluZyB0aGlzIG9uIGRvY3VtZW50LmJvZHlcclxuLy8gaW5zdGVhZCBvZiBvbiB0aGUgbGlzdCBlbGVtZW50cyBiZWNhdXNlIHRoZSB1c2VyIGNhbiBob2xkIGRvd24gdGhlIGtleSB3aGlsZVxyXG4vLyBzdGlsbCBtb3ZpbmcgdGhlIG1vdXNlLCB3aGljaCBtZXNzZXMgaXQgYWxsIHVwXHJcbmRvY3VtZW50LmJvZHkub25tb3VzZXVwID0gZnVuY3Rpb24oKXtcclxuICAgc3ludGguc3RvcCgpO1xyXG59O1xyXG5cclxuLypcclxuIFNoaWZ0aW5nIHRoZSBrZXlib2FyZCB0byB0aGUgbGVmdCBvciByaWdodCB1c2luZyB0aGUgb2N0YXZlIGNvbnRyb2xzXHJcbiAqL1xyXG5sZXQgb2N0YXZlUmFuZ2UgPSAxOyAvLyBUaGUgZGVmYXVsdCBzdGF0ZVxyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbZGF0YS1jdHJsPVwib2N0YXZlLWxlZnRcIl0nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XHJcbiAgICBpZiggIXRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkge1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLWN0cmw9XCJvY3RhdmUtcmlnaHRcIl0nKS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICBvY3RhdmVSYW5nZSsrO1xyXG4gICAgICAgIGlmKCBvY3RhdmVSYW5nZSA+IDEgKSB0aGlzLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xyXG4gICAgICAgIG1vdmVLZXlib2FyZE9jdGF2ZSgnZG93bicpO1xyXG4gICAgfVxyXG59KTtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3RybD1cIm9jdGF2ZS1yaWdodFwiXScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcclxuICAgIGlmKCAhdGhpcy5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2RhdGEtY3RybD1cIm9jdGF2ZS1sZWZ0XCJdJykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgb2N0YXZlUmFuZ2UtLTtcclxuICAgICAgICBpZiggb2N0YXZlUmFuZ2UgPCAxICkgdGhpcy5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICBtb3ZlS2V5Ym9hcmRPY3RhdmUoJ3VwJyk7XHJcbiAgICB9XHJcbn0pO1xyXG5mdW5jdGlvbiBtb3ZlS2V5Ym9hcmRPY3RhdmUoIGRpcmVjdGlvbiApe1xyXG4gICAgbGV0IGhhbGZTdGVwO1xyXG4gICAgaWYoIGRpcmVjdGlvbiA9PT0gJ3VwJyApe1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgaGFsZlN0ZXAgPSBwYXJzZUludChpdGVtc1tpXS5kYXRhc2V0LmhhbGYpICsgMTI7XHJcbiAgICAgICAgICAgIGl0ZW1zW2ldLmRhdGFzZXQuaGFsZiA9IGhhbGY7XHJcbiAgICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgIGhhbGZTdGVwID0gcGFyc2VJbnQoaXRlbXNbaV0uZGF0YXNldC5oYWxmKSAtIDEyO1xyXG4gICAgICAgICAgICBpdGVtc1tpXS5kYXRhc2V0LmhhbGYgPSBoYWxmO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCBPc2NpbGxhdG9yIGZyb20gXCIuL3N5bnRoX2NvbXBvbmVudHMvb3NjaWxsYXRvclwiO1xyXG5cclxuY2xhc3MgU3ludGh7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0KXtcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgICAgIHRoaXMub3NjaWxsYXRvcnMgPSBbXHJcbiAgICAgICAgICAgIG5ldyBPc2NpbGxhdG9yKGNvbnRleHQpLFxyXG4gICAgICAgICAgICBuZXcgT3NjaWxsYXRvcihjb250ZXh0KVxyXG4gICAgICAgIF07XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IE9zY2lsbGF0b3JzKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3NjaWxsYXRvcnM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RnJlcXVlbmN5KGhhbGZTdGVwKXtcclxuICAgICAgICB0aGlzLm9zY2lsbGF0b3JzLmZvckVhY2goZnVuY3Rpb24ob3NjKXtcclxuICAgICAgICAgICAgb3NjLnNldEZyZXF1ZW5jeShoYWxmU3RlcCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhcnQoKXtcclxuICAgICAgICB0aGlzLm9zY2lsbGF0b3JzLmZvckVhY2goZnVuY3Rpb24ob3NjKXtcclxuICAgICAgICAgICAgb3NjLnN0YXJ0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RvcCgpe1xyXG4gICAgICAgIHRoaXMub3NjaWxsYXRvcnMuZm9yRWFjaChmdW5jdGlvbihvc2Mpe1xyXG4gICAgICAgICAgIG9zYy5zdG9wKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFN5bnRoOyIsImNsYXNzIE9zY2lsbGF0b3J7XHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0KXtcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgfVxyXG4gICAgc2V0RnJlcXVlbmN5KGhhbGZTdGVwKXtcclxuICAgICAgICB0aGlzLmZyZXF1ZW5jeSA9IDQ0MCAqICggTWF0aC5wb3coIE1hdGgucG93KDIsIDEvMTIpLCBoYWxmU3RlcCkgKTtcclxuICAgIH1cclxuICAgIHN0YXJ0KCl7XHJcbiAgICAgICAgdGhpcy5vc2NpbGxhdG9yID0gdGhpcy5jb250ZXh0LmNyZWF0ZU9zY2lsbGF0b3IoKTtcclxuICAgICAgICB0aGlzLm9zY2lsbGF0b3IuY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pO1xyXG4gICAgICAgIHRoaXMub3NjaWxsYXRvci5mcmVxdWVuY3kudmFsdWUgPSB0aGlzLmZyZXF1ZW5jeTtcclxuICAgICAgICB0aGlzLm9zY2lsbGF0b3Iuc3RhcnQoKTtcclxuICAgIH1cclxuICAgIHN0b3AoKXtcclxuICAgICAgICB0aGlzLm9zY2lsbGF0b3Iuc3RvcCgpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBPc2NpbGxhdG9yOyJdfQ=="}